/* ★B が攻めてくるが A がはじき返して勝つパターン */
function playCounterFinish(el, prevIdx, finalIdx){
  const nameA = currentList[prevIdx];    // 勝者（前の人）
  const nameB = currentList[finalIdx];   // 攻めてくる次の人

  // ① B が「当たりそう」な顔を見せる
  el.textContent = nameB;
  el.animate(
    [
      { transform:"translateX(0) scale(1)" },
      { transform:"translateX(0) scale(1.3)" },
      { transform:"translateX(0) scale(1)" }
    ],
    { duration:350, easing:"ease-out" }
  );

  // ② 小競り合い（AとBがガツガツぶつかる）
  setTimeout(() => {
    let count = 0;
    const clash = () => {
      if (count >= 3) {
        // 小競り合い終了 → 負けた B をクルクル飛ばす
        flyOutLoserAndShowWinner();
        return;
      }
      const who = (count % 2 === 0) ? nameB : nameA;
      el.textContent = who;
      el.animate(
        [
          { transform:"translateX(0)" },
          { transform:"translateX(20px)" },
          { transform:"translateX(-20px)" },
          { transform:"translateX(0)" }
        ],
        { duration:220, easing:"ease-in-out" }
      );
      count++;
      setTimeout(clash, 230);
    };
    clash();
  }, 380);

  // ③ B が左へクルクル飛んで、A が中央に残る
  function flyOutLoserAndShowWinner(){
    // B を画面左の外へクルクルしながら飛ばす
    el.textContent = nameB;
    el.animate(
      [
        { transform:"translateX(0) rotate(0deg) scale(1)",    opacity:1 },
        { transform:"translateX(-260px) rotate(-720deg) scale(0.6)", opacity:0 }
      ],
      { duration:550, easing:"ease-in" }
    );

    setTimeout(() => {
      // A が右から戻ってきて勝者ポーズ
      el.textContent = nameA;
      el.animate(
        [
          { transform:"translateX(260px) scale(1.2)", opacity:0 },
          { transform:"translateX(0)   scale(1)",     opacity:1 }
        ],
        { duration:450, easing:"ease-out" }
      );

      setTimeout(() => {
        el.animate(
          [
            { transform:"scale(1)"   },
            { transform:"scale(1.3)" },
            { transform:"scale(1)"   }
          ],
          { duration:320, easing:"ease-out" }
        );
        setTimeout(() => {
          finishSelection(prevIdx, "special");
        }, 330);
      }, 460);
    }, 560);
  }
}
