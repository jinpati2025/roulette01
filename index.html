function startRoulette() {
  if (spinning || !currentList.length) {
    alert('名簿がありません');
    return;
  }
  spinning = true;

  const sound = soundFiles[Math.floor(Math.random() * soundFiles.length)];
  audio = new Audio(baseUrl + sound);

  audio.addEventListener('loadedmetadata', () => {
    const duration = audio.duration; // 音声の長さ（秒）
    const totalSteps = 38; // 実質的な回転回数（フェイント除く）
    const baseInterval = (duration * 1000) / (totalSteps + 2); // フェイント分も加味

    audio.play();

    let spins = 0;

    const step = () => {
      if (spins >= totalSteps) {
        // フェイント演出前に止まりかけてみせる
        setTimeout(() => {
          // 一度「止まったように見せる」
          const fakeIdx = (currentIndex + currentList.length - 1) % currentList.length;
          document.getElementById('roulette').textContent = currentList[fakeIdx];

          // そして…もう1回だけ！
          setTimeout(() => {
            // 最終選出
            const selIdx = (fakeIdx + 1) % currentList.length;
            const selected = currentList[selIdx];
            document.getElementById('roulette').textContent = selected;
            document.getElementById('history').innerHTML += `<li>${selected}</li>`;
            if (!allowDuplicates) {
              currentList.splice(selIdx, 1);
            }
            currentIndex = 0;
            spinning = false;

            if (audio) {
              audio.pause();
              audio.currentTime = 0;
            }

            const el = document.getElementById("roulette");
            el.classList.add("highlight");
            rollCount++;
            if (rollCount % 5 === 0) applySpecialEffect(el);
            setTimeout(() => el.classList.remove("highlight"), 1000);
          }, 600); // 騙し→本当の選出（0.6秒後）

        }, 400); // 停止フェイント（0.4秒停止後）
        return;
      }

      // 表示更新
      document.getElementById('roulette').textContent = currentList[currentIndex];
      currentIndex = (currentIndex + 1) % currentList.length;
      spins++;

      // 後半に向かって減速
      let delay = baseInterval;
      if (spins > totalSteps * 0.7) {
        delay *= 1.6;
      } else if (spins > totalSteps * 0.5) {
        delay *= 1.3;
      }

      setTimeout(step, delay);
    };

    step();
  });
}
